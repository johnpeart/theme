<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
	<title>{{ site.title | xml_escape }} • All posts</title>
	<description>{{ site.description | xml_escape }}</description>
	<image>
		<url>{{ site.url | append: site.baseurl | append: site.social-media-image }}</url>
		<title>{{ site.title | xml_escape }} • All posts</title>
		<link>{{ site.url | append: site.baseurl }}/</link>
	</image>
	<link>{{ site.url | append: site.baseurl }}/</link>
	<atom:link href="{{ '/feed.xml' | prepend: site.baseurl | prepend: site.url }}" rel="self" type="application/rss+xml"/>
	<pubDate>{{ site.time | date_to_rfc822 }}</pubDate>
	<lastBuildDate>{{ site.time | date_to_rfc822 }}</lastBuildDate>
	<copyright>Copyright {{ site.time | date: "%Y" }} John Peart. Please attribute and link to my work.</copyright>
	<generator>Jekyll v{{ jekyll.version }}</generator>

	{%- assign allposts = site.documents | where_exp: "item", "
		item.collection == 'blogpost' or
		item.collection == 'note' or
		item.collection == 'photo' or
		item.collection == 'list' or
		item.collection == 'game' or
		item.collection == 'music'
	" | sort: date | reverse -%}

	{%- for post in allposts %}

		{%- if post.collection == "blogpost" %}
			{% assign title = post.title | strip_html %}
			{% assign type = "article" %}
		{%- elsif post.collection == "reply" %}
			{% assign title = post.reply_to.author.name | prepend: "↩️ In reply to " | strip_html %}
			{% assign type = "reply" %}
			{% assign image = site.url | append: site.baseurl | append: site.image-path | append: site.reply-image %}
		{%- elsif post.collection == "note" %}
			{% assign title = post.title | prepend: "🗒️ " | strip_html %}
			{% assign type = "note" %}
		{%- elsif post.collection == "share" %}
			{% assign title = post.reply_to.post.title | prepend: "🔁 Commented on “" | append: "”" | strip_html %}
			{% assign type = "share" %}
		{%- elsif post.collection == "music" %}
			{% assign title = post.title | prepend: "🎧 Shared “" | append: "” by " | append: post.artist | strip_html %}
			{% assign type = "music" %}
		{%- elsif post.collection == "photo" %}
			{% assign title = post.title | prepend: "📷 " | strip_html %}
			{% assign type = "photo" %}
		{%- elsif post.collection == "game" %}
			{% assign title = post.title | prepend: "🎮 Shared ”" | append: "“" | strip_html %}
			{% assign type = "game" %}
		{%- elsif post.title -%}
			{% assign title = post.title | strip_html | strip_newlines %}
			{% assign type = "article" %}
		{%- else -%}
			{% assign title = site.title | strip_html | strip_newlines %}
			{% assign type = "website" %}
		{%- endif -%}

	<item>
		<title>{{ title | xml_escape }}</title>
		<pubDate>{{ post.date | date_to_rfc822 }}</pubDate>
		<link>{{ post.url | prepend: site.baseurl | prepend: site.url }}</link>
		<guid isPermaLink="true">{{ post.url | prepend: site.baseurl | prepend: site.url }}</guid>
		{%- for tag in post.tags %}
		<category>{{ tag | xml_escape }}</category>
		{% endfor -%}
		{%- for cat in post.categories %}
		<category>{{ cat | xml_escape }}</category>
		{% endfor -%}
		<description>
			{% if post.image and post.image contains "://" %}
				{% assign image = post.image %}
			{% elsif post.image %}
				{% assign image = site.url | append: site.baseurl | append: site.image-path | append: post.image %}
			{% elsif post.collection %}
				{% assign image = site.url | append: site.baseurl | append: site.image-path | append: '/site/social-media-' | append: post.collection | append: ".png" %}
			{% else %}
				{% assign image = site.url | append: site.baseurl | append: site.social-media-image %}
			{% endif %}

			&lt;img src=&quot;{{ image }}&quot; alt=&quot;{{ post.image-alt }}&quot; /&gt;

			{{ post.content | xml_escape -}}
		</description>
	</item>
	{% endfor %}

	{% for post in site.posts limit:1000 %}
	{% if post.sitemap != false %}
	  <item>
		<title>{{ post.title | xml_escape }}</title>
		<description>{{ post.content | xml_escape }}</description>
		<pubDate>{{ post.date | date_to_rfc822 }}</pubDate>
		<link>{{ post.url | prepend: site.baseurl | prepend: site.url }}</link>
		<guid isPermaLink="true">{{ post.url | prepend: site.baseurl | prepend: site.url }}</guid>
		{% for tag in post.tags %}
		<category>{{ tag | xml_escape }}</category>
		{% endfor %}
		{% for cat in post.categories %}
		<category>{{ cat | xml_escape }}</category>
		{% endfor %}
	  </item>
	  {% endif %}
	{% endfor %}


  </channel>
</rss>
